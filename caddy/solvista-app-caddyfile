app.solvista.nl {

    handle_path /iam/* {
        root * /opt/apps/solvista-iam/frontend
        file_server

        # SPA routing
        try_files {path} /index.html

        # Cache busted assets (Vite fingerprints filenames)
        @static {
            path *.js *.css *.png *.jpg *.jpeg *.gif *.svg *.ico *.woff *.woff2
        }
        header @static Cache-Control "public, max-age=31536000, immutable"

        # HTML must revalidate
        @html {
            path *.html
        }
        header @html Cache-Control "no-cache"

        header {
            X-Content-Type-Options nosniff
            X-Frame-Options DENY
            Referrer-Policy strict-origin-when-cross-origin
        }
        encode gzip
    }
}
